import EventEmitter from 'events';
import { ImportedModule, ModuleVulnerabilityCount } from './importedModule';

export enum VulnerabilityCountEvents {
  Start = 'start',
  Scanned = 'scanned',
  Done = 'done',
  Error = 'error',
}

export class VulnerabilityCountEmitter extends EventEmitter {
  startScanning(importedModules: ImportedModule[]): void {
    this.emit(VulnerabilityCountEvents.Start, importedModules);
  }

  scanned(moduleInfo: ModuleVulnerabilityCount): void {
    this.emit(VulnerabilityCountEvents.Scanned, moduleInfo);
  }

  done(moduleInfos: ModuleVulnerabilityCount[]): void {
    this.emit(VulnerabilityCountEvents.Done, moduleInfos);
  }

  // eslint-disable-next-line @typescript-eslint/no-redundant-type-constituents
  error(error: Error | unknown): void {
    this.emit(VulnerabilityCountEvents.Error, error);
  }
}
