import EventEmitter from 'events';
import { ImportedModule, ModuleVulnerabilityCount } from './services/vulnerabilityCount/importedModule';

export enum VulnerabilityCountEvents {
  PackageJsonFound = 'packageJsonFound',
  Start = 'start',
  Scanned = 'scanned',
  Done = 'done',
  Error = 'error',
}

export class VulnerabilityCountEmitter extends EventEmitter {
  packageJsonFound(fileName: string): void {
    this.emit(VulnerabilityCountEvents.PackageJsonFound, fileName);
  }

  startScanning(importedModules: ImportedModule[]): void {
    this.emit(VulnerabilityCountEvents.Start, importedModules);
  }

  scanned(moduleInfo: ModuleVulnerabilityCount): void {
    this.emit(VulnerabilityCountEvents.Scanned, moduleInfo);
  }

  done(moduleInfos: ModuleVulnerabilityCount[]): void {
    this.emit(VulnerabilityCountEvents.Done, moduleInfos);
  }

  error(error: Error | unknown): void {
    this.emit(VulnerabilityCountEvents.Error, error);
  }
}
